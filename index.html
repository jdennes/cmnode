<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>cmnode</title>
    <style type="text/css">body { font-family: Georgia; }</style>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js" type="text/javascript"></script>
  </head>
  <body>
    <h3>Monitoring a campaign in realtime...</h3>
    <h4 id="campaign"></h4>
    <div>Opens: <span id="opens"></span> Unique Opens: <span id="uniqueopens"></span> 
      Clicks: <span id="clicks"></span> Unsubscribes: <span id="unsubscribes"></span> Bounces: <span id="bounces"></span></div>
    <div id="new" style="width: 100%; height: 100%;"></div>
    <script type="text/javascript">
      //<![CDATA[
      $(document).ready(function() {
        var ws;
        function openSocket() {
          ws = new WebSocket("ws://127.0.0.1:8000/");
          ws.onmessage = function(evt) { 
            var data = JSON.parse(evt.data);
            $("#new").append(data.New);
            $("h4#campaign").html("Campaign: " + data.CampaignName);
            $("span#opens").html(data.Opens);
            $("span#uniqueopens").html(data.UniqueOpens);
            $("span#clicks").html(data.Clicks);
            $("span#unsubscribes").html(data.Unsubscribes);
            $("span#bounces").html(data.Bounces);
          };
          ws.onclose = function() {};
          ws.onopen = function() {};
        }
        openSocket();
      });
      //]]>
</script>
  </body>
</html>
